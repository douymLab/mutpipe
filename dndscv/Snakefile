sample_IDs, =glob_wildcards("path/to/input/{sample}.SNV.out")


rule all:
	input:
		"path/to/output/drivergene.csv"

rule generate_input_persample:
	input:
		SNV="path/to/input/{sample}.SNV.out",
		Indel="path/to/input/{sample}.INDEL.out"
	output:
		SNV=temp("path/to/output/{sample}.SNV.input"),
		Indel=temp("path/to/output/{sample}.INDEL.input")
	shell:
		"cat {input.SNV}|while read line; do echo \"{wildcards.sample} $line\"; done|"
		"sed 's/ /\t/g'|cut -f 1,2,3,5,6 >> {output.SNV};"
		"cat {input.Indel}|while read line; do echo \"{wildcards.sample} $line\"; done|"
		"sed 's/ /\t/g'|cut -f 1,2,3,5,6 >> {output.Indel};"

rule merge_input:
	input:
		expand("path/to/output/{sample}.{type}.input", sample=sample_IDs, type=type)
	output:
		"path/to/output/drivergene.input"
	shell:
		"cat {input} >> {output}"

rule dndscv:
	input:
		"path/to/output/drivergene.input"
	output:
		"path/to/output/drivergene.csv"
	params:
		"resources/RefCDS_human_GRCh38.p12_dNdScv.0.1.0.rda"
	shell:
		"Rscript drivergene.R {input} {params} {output}"
